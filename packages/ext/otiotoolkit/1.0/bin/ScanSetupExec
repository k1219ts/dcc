#!/usr/bin/python2.7
from __future__ import print_function
import os, sys
from PySide2 import QtWidgets

if __name__ == '__main__':
    selected = os.getenv('NAUTILUS_SCRIPT_SELECTED_FILE_PATHS')
    if not selected:
        sys.exit(0)

    selected = selected.split('\n')[0]

    app = QtWidgets.QApplication(sys.argv)
    from core.PlateSetupArgument import PlateSetupArgumentDialog
    import PlateSetup

    print(PlateSetup.__file__)

    dialog = PlateSetupArgumentDialog(xlsFilePath=selected)
    dialog.exec_()
    if dialog.result == True:
        print(selected, dialog.scanRootEdit.text(), dialog.shotNameEdit.text().split(' '))
        shotNameList = []
        if dialog.shotNameEdit.text() != '':
            shotNameList = dialog.shotNameEdit.text().split(' ')
        PlateSetup.doIt(selected, dialog.scanRootEdit.text(), shotNameList, dialog.versionUp.isChecked())
    # else:
    #     PlateSetup.doIt(selected)

    print("# Complete!")

    sys.exit(0)
